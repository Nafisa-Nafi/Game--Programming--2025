<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Sketch</title>
    <style>
        body {
            font-family: Arial;
            margin: 10px
        }

        #panel {
            border: 1px solid #333;
            padding: 8px 10px;
            max-width: 520px;
            margin-bottom: 8px
        }

        .c {
            width: 95vw;
            height: 60vh;
            border: 1px dashed #999;
            display: block
        }

        .meta {
            font-size: 12px;
            color: #444
        }
    </style>
</head>

<body>
    <h2>Sketch â€” 5-minute play</h2>

    <div id="panel">
        <div class="meta">Time left: <span id="timer">05:00</span> | Step <span id="step">1</span>/5</div>
        <p id="instruction"><strong>Draw 5 loose circles to warm up.</strong></p>
        <div class="meta">New prompt every minute. </div>
    </div>

    <p>Weight <input id="size" type="range" min="1" max="18" value="6">
        Hardness <input id="hard" type="range" min="0.2" max="1" step="0.05" value="0.8">
        <button id="clear">Clear</button>
        <button id="save">Save PNG</button>
    </p>

    <canvas id="pad" class="c"></canvas>

    <script>
        // timer + prompts
        const prompts = [
            "Draw 5 loose circles to warm up.",
            "Outline a simple self-portrait in 10 lines.",
            "Add hair and a hoodie or scarf.",
            "Add 3 quick background objects (mug, book, window).",
            "Add shadows with light cross-hatching."
        ];
        let seconds = 300, minuteIndex = 0;
        const instruction = document.getElementById('instruction');
        const stepEl = document.getElementById('step');
        const timerEl = document.getElementById('timer');
        function setPrompt(i) { instruction.textContent = prompts[i]; stepEl.textContent = i + 1; }
        function tick() {
            seconds--;
            const m = String(Math.floor(seconds / 60)).padStart(2, '0');
            const s = String(seconds % 60).padStart(2, '0');
            timerEl.textContent = m + ":" + s;
            const newIndex = 4 - Math.floor(seconds / 60);
            if (newIndex !== minuteIndex && newIndex >= 0 && newIndex < 5) { minuteIndex = newIndex; setPrompt(minuteIndex); }
            if (seconds <= 0) { location.href = "done.html"; clearInterval(int); }
        }
        setPrompt(0);
        const int = setInterval(tick, 1000);

        // sketch pad
        const c = document.getElementById('pad'), x = c.getContext('2d');
        function fit() { c.width = c.clientWidth; c.height = c.clientHeight; } fit();
        let draw = false, last = [0, 0], sz = 6, hard = 0.8;
        size.oninput = e => sz = +e.target.value; hard.oninput = e => hard = +e.target.value;
        clear.onclick = () => x.clearRect(0, 0, c.width, c.height);
        save.onclick = () => { let a = document.createElement('a'); a.download = 'sketch.png'; a.href = c.toDataURL(); a.click(); };
        const p = e => { const r = c.getBoundingClientRect(); const t = e.touches ? e.touches[0] : e; return [t.clientX - r.left, t.clientY - r.top]; };
        const start = e => { draw = true; last = p(e); e.preventDefault(); };
        const move = e => {
            if (!draw) return;
            const [X, Y] = p(e);
            x.lineCap = 'round'; x.lineJoin = 'round';
            x.strokeStyle = `rgba(60,60,60,${hard})`; x.lineWidth = sz;
            x.beginPath(); x.moveTo(last[0], last[1]); x.lineTo(X, Y); x.stroke();
            last = [X, Y]; e.preventDefault();
        };
        const end = () => draw = false;
        c.addEventListener('mousedown', start); c.addEventListener('mousemove', move); addEventListener('mouseup', end);
        c.addEventListener('touchstart', start, { passive: false }); c.addEventListener('touchmove', move, { passive: false }); addEventListener('touchend', end);
        addEventListener('resize', fit);
    </script>
</body>

</html>